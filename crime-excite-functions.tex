First step is to load function \texttt{inpoly}, which find whether each of an array of points is inside or outside of a given polygon.

Let us introduce function \texttt{hist.weighted.2D} and \texttt{ker.smooth.2D.fft}.
 
\begin{Schunk}
\begin{Sinput}
> source('~/Share/Mylib/Rsrc/inpoly.r')